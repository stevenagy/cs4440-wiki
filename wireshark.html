<!DOCTYPE html>
<html lang="en">
<head>
    <title>CS 4440</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons/css/academicons.min.css">
    <link rel="stylesheet" href="css/main.css"/>
    <link rel="icon" type="image/x-icon" href="../../../img/favicon.ico">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.1/styles/default.min.css">
    <script src="https://kit.fontawesome.com/982c2a20d7.js" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.1/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
</head>

<body>

<nav class="navbar navbar-inverse">
    <a class="navbar-brand" href="http://cs.utah.edu">
        <img class="button" width="185px" src="../../../img/ksoclogo_white.png" style="margin-top:1.3%">
    </a>

    <div class="ml-auto">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#myNavbar">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
        </div>
        
        <div class="collapse navbar-collapse" id="myNavbar">
            <ul class="nav navbar-nav" style="margin-top: 1px;">
                <li><a href="../">Syllabus</a></li>
                <li><a href="../schedule">Schedule</a></li>
                <li><a href="../assignments">Assignments</a></li>
                <li><a href="../wiki">Wiki</a></li>
                <li><a href="../redirect_piazza">Piazza</a></li>
                <li><a href="../redirect_canvas">Canvas</a></li>
                <li><a href="../redirect_pollev">PollEv</a></li>
                <li><a href="../redirect_taqueue">TA&nbsp;Queue</a></li>
            </ul>
        </div>
    </div>
</nav>

<!-- ################################################################################### -->

<div class="container main-container">
    <div class="col-md-10">
        <h1>CS 4440 Wiki: <br class="on-narrow"><b style="color:dodgerblue">Wireshark Tutorial</b></h1><br>

    <!-- ################################################################################### -->

        <p>Below is an abridged cheat sheet of Wireshark fundamentals that you'll use in this course.</p>

        <p><b>This page is by no means comprehensive—we encourage you to bookmark and familiarize yourself with one of the many in-depth Wireshark tutorials on the web.</b> Some great examples are:</p>

        <ul>
            <li><a href="https://www.wireshark.org/docs/wsug_html_chunked/">Wireshark User's Guide</a></li>
        </ul>

    <!-- ################################################################################### -->

        <hr><h2 id=basics>Wireshark Basics</h2>
        <p>Wireshark is a graphical packet analyzer. We recommend using Wireshark for <b>manual packet inspection</b> to aid in developing your solutions for Project 4.</p>

        <br><br>

        <h3 id=basics#run>Running Wireshark Inside the VM</h3>
        <p>To run Wireshark inside your VM, launch the interactive menu (accessible via the bottom-left-most icon). Navigate to the Internet tab, and select Wireshark.</p>
        <p><img class="button wikiimage" src="img/wireshark-run.png" style="max-width:70%"/></p>

        <br><br>

        <h3 id=basics#open>Opening Packet Capture Files</h3>
        <p>In Project 4, we provide you with a set of network packet captures (<code>.pcap</code> files). To start analyzing these packets with Wireshark, click on <b>File</b> and then <b>Open</b>. Select your <code>pcap</code> file of choice. </p>
        <p><img class="button wikiimage" src="img/wireshark-open.png" style="max-width:70%"/></p>

        <br><br>

    <!-- ################################################################################### -->

        <hr><h2 id=navigation>Navigating Wireshark</h2>

        <h3 id=navigation#main>Main Window</h3>
        <p> After selecting a <code>.pcap</code> file, you will be taken to the <b>Main Window</b>. Here you will find three essential panes for packet analysis: the <b>Packet List</b> pane, the <b>Packet Details</b> pane, and the <b>Packet Bytes</b> pane.</p>
        <p><img class="button wikiimage" src="img/wireshark-main.png" style="max-width:70%"/></p>

        <br><br>

        <h3 id=navigation#list>Packet List</h3>
        <p> The <b>Packet List</b> displays a complete list of packets captured in the selected trace. You can <b>double-click</b> on any packet to inspect it.</p>
        <p><img class="button wikiimage" src="img/wireshark-list.png" style="max-width:70%"/></p>

        <br><br>

        <p> There are several important columns to check out: </p>
        <ul>
            <li><b>No</b>: The order number of the packet.</li>
            <li><b>Time</b>: The timestamp of the packet.</li>
            <li><b>Source</b>: The source address of the packet. This is where the packet came from.</li>
            <li><b>Destination</b>: The destination address of the packet. This is where the packet is headed.</li>
            <li><b>Protocol</b>: The type of protocol the packet is using. Examples include <b>TCP</b>, <b>HTTP</b>, <b>SMTP</b>, <b>FTP</b>, <b>IMAP</b>, etc.</li>
            <li><b>Length</b>: The length of the packet in bytes.</li>
            <li><b>Info</b>: Additional packet info.</li>
        </ul>

        <br><br>

        <h3 id=navigation#details>Packet Details</h3>
        <p> After selecting a packet, you can explore the fields and information contained in each of the packet's layers. The <b>Packet Details</b> pane begins with the packet's link layer <i>frame</i> and ends with its app layer <i>application protocol</i> (if applicable for the packet).</p>
        <p><img class="button wikiimage" src="img/wireshark-details.png" style="max-width:70%"/></p><br><br>

        <p> Select a layer to inspect: </p>
        <ul>
            <li id=details#link><b>Link Layer: </b>Includes the source and destination <b>MAC</b> addresses, as well as the network protocol.</li>
            <p><img class="button wikiimage" src="img/wireshark-details-link.png" style="max-width:70%"/></p><br><br>

            <li id=details#network><b>Network Layer: </b>Includes the network protocol, <b>source address</b>, and <b>destination address</b>. These match the corresponding columns in the <b>Packet List</b>.</li>
            <p><img class="button wikiimage" src="img/wireshark-details-network.png" style="max-width:70%"/></p><br><br>

            <li id=details#transport><b>Transport Layer: </b>Includes the <b>source port</b>, <b>destination port</b>, and relative sequence and acknowledgment numbers which help track the order of packets in TCP connections.</li>
            <p><img class="button wikiimage" src="img/wireshark-details-transport.png" style="max-width:70%"/></p><br><br>
            <p> The transport layer also contains relative <b>flags</b> for the specific packet and protocol. </p>
            <p><img class="button wikiimage" src="img/wireshark-details-flags.png" style="max-width:70%"/></p><br><br>

            <li id=details#app><b>Application Layer: </b>Includes details specific to the application protocol.</li>
            <p><img class="button wikiimage" src="img/wireshark-details-app.png" style="max-width:70%"/></p><br><br>
        </ul>

        <br><br>

        <h3 id=navigation#bytes>Packet Bytes</h3>
        <p>Utilize this pane to explore the complete raw packet data, including both hexadecimal values (left) and corresponding ASCII representations (right).</p>
        <p><img class="button wikiimage" src="img/wireshark-bytes.png" style="max-width:70%"/></p>

        <br><br>

    <!-- ################################################################################### -->

        <hr><h2 id=tips>Helpful Tips & Tricks</h2>

        <h3 id=tips#filters>Filter Toolbar</h3>
        <p>The <b>Filter</b> toolbar can help you quickly apply <b>display filters</b> to the <b>Packet List</b>.</p>
        <p><img class="button wikiimage" src="img/wireshark-filter.png" style="max-width:70%"/></p>

        <br><br>

        <h3 id=filters#operators>Filter Operators</h3>

        <p id=operators#eq><b><code>eq</code> or <code>==</code> : </b> Equality comparison operator</p>
        <pre>tcp.srcport eq 21</pre>

        <p id=operators#not><b><code>!</code> : </b> Not operator</p>
        <pre>!(tcp.srcport eq 21)</pre>

        <p id=operators#not><b><code>and</code> : </b> And operator</p>
        <pre>tcp.flags.syn eq 1 and tcp.flags.ack eq 1</pre>

        <p id=operators#not><b><code>or</code> : </b> Or operator</p>
        <pre>tcp.flags.syn eq 1 or tcp.flags.ack eq 1</pre>

        <h3 id=filters#examples>Filter Examples</h3>

        <p id=examples#protocol><b><code>&#10092;protocol&#10093;</code> : </b> Filter by protocol type</p>
        <pre>ftp</pre>

        <p id=examples#ip><b><code>ip.addr eq &#10092;ip&#10093;</code> : </b> Filter by IP address</p>
        <pre>ip.addr eq 192.168.56.1</pre>

        <p id=examples#src><b><code>ip.src eq &#10092;ip&#10093;</code> : </b> Filter by source IP address</p>
        <pre>ip.src eq 192.168.56.1</pre>

        <p id=examples#dst><b><code>ip.dst eq &#10092;ip&#10093;</code> : </b> Filter by destination IP address</p>
        <pre>ip.dst eq 192.168.56.1</pre>

        <p id=examples#port><b><code>tcp.port eq &#10092;port number&#10093;</code> : </b> Filter by port number</p>
        <pre>tcp.port eq 54017</pre>

        <p id=examples#srcport><b><code>tcp.srcport eq &#10092;port number&#10093;</code> : </b> Filter by source port number</p>
        <pre>tcp.srcport eq 54017</pre>

        <p id=examples#dstport><b><code>tcp.dstport eq &#10092;port number&#10093;</code> : </b> Filter by destination port number</p>
        <pre>tcp.dstport eq 54017</pre>

        <p id=examples#dst><b><code>tcp.flags.&#10092;flag&#10093; eq 1</code> : </b> Filter by flags</p>
        <pre>tcp.flags.syn eq 1</pre>

        <p id=examples#dst><b><code>tcp.stream eq &#10092;stream number&#10093;</code> : </b> Filter by stream</p>
        <pre>tcp.stream eq 0</pre>

        <br><br>

        <h3 id=tips#follow>Follow Specific Protocol Stream</h3>
        <p>To follow a specific protocol stream/connection, <b>right-click</b> on the packet from the desired stream, select <b>Follow</b>, and choose the corresponding protocol stream you wish to view (as seen below). You may also find the <b>Follow</b> option under <b>Analyze</b>.</p>
        <p><img class="button wikiimage" src="img/wireshark-follow.png" style="max-width:70%"/></p>

        <p>This will apply a display filter to the <b>Packet List</b>, showing only packets from the selected stream (as an example, it may apply a filter like <code>tcp.stream eq &#10092;stream number&#10093;</code>). <i>Additionally</i>, a separate window will open displaying the stream content in a more readable format.</p>

        <br>

    <!-- ################################################################################### -->


    <!-- ################################################################################### -->
    </div>
    <div class="col-md-2 text-left scrollable" style="position:static;">
        <div class="col-md-12 text-left scrollable" style="position:fixed;">
            <h4><b>Table of Contents:</b></h4>
                <ul>
                    <li><a href="#basics">Wireshark Basics</a></li>
                    <ul>
                        <li><a href="#basics#run">Running Wireshark</a></li>
                        <li><a href="#basics#open">Opening PCAP Files</a></li>
                    </ul>
                    <li style="margin-top:1ex"><a href="#navigation">Navigating Wireshark</a></li>
                    <ul>
                        <li><a href="#navigation#main">Main Window</a></li>
                        <li><a href="#navigation#list">Packet List</a></li>
                        <li><a href="#navigation#details">Packet Details</a></li>
                        <ul>
                            <li><a href="#details#link">Link Layer</a></li>
                            <li><a href="#details#network">Network Layer</a></li>
                            <li><a href="#details#transport">Transport Layer</a></li>
                            <li><a href="#details#app">Application Layer</a></li>
                        </ul>
                        <li style="margin-top:1ex"><a href="#navigation#bytes">Packet Bytes</a></li>
                    </ul>
                    <li style="margin-top:1ex"><a href="#tips">Helpful Tips & Tricks</a></li>
                    <ul>
                        <li><a href="#tips#filters">Filter Toolbar</a></li>
                        <ul>
                            <li><a href="#filters#operators">Filter Operators</a></li>
                            <li><a href="#filters#examples">Filter Examples</a></li>
                        </ul>
                        <li style="margin-top:1ex"><a href="#tips#follow">Following Streams</a></li>
                    </ul>
                </ul>
            </h4>
        </div>
    </div>

</div>

<!-- ################################################################################### -->

<footer class="bg-light text-center text-lg-start">
    <div class="text-center p-3" style="background-color: rgba(0, 0, 0, 0.2); font-size: 0.75em;">
        Copyright © Stefan Nagy. All rights reserved.
    </div>
</footer>

<!-- ################################################################################### -->

</body>

</html>